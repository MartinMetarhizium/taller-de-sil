{"ast":null,"code":"import { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, Fragment as _Fragment } from \"vue\";\nconst _hoisted_1 = {\n  key: 0\n};\nconst _hoisted_2 = {\n  class: \"img-wrap\"\n};\nconst _hoisted_3 = [\"src\"];\nconst _hoisted_4 = {\n  class: \"product-details\"\n};\nconst _hoisted_5 = {\n  key: 1,\n  class: \"grey-button\"\n};\nconst _hoisted_6 = {\n  key: 1\n};\nexport function render(_ctx, _cache) {\n  const _component_NotFoundPage = _resolveComponent(\"NotFoundPage\");\n  return _openBlock(), _createElementBlock(_Fragment, null, [_ctx.product ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"img\", {\n    src: _ctx.product.imageUrl\n  }, null, 8 /* PROPS */, _hoisted_3)]), _createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"h1\", null, _toDisplayString(_ctx.product.name), 1 /* TEXT */), _createElementVNode(\"h3\", null, _toDisplayString(_ctx.product.price), 1 /* TEXT */), _ctx.user && !_ctx.itemsIsInCart ? (_openBlock(), _createElementBlock(\"button\", {\n    key: 0,\n    onClick: _cache[0] || (_cache[0] = (...args) => _ctx.addToCart && _ctx.addToCart(...args)),\n    class: \"add-to-cart\"\n  }, \" Add to cart\")) : _createCommentVNode(\"v-if\", true), _ctx.user && _ctx.itemsIsInCart ? (_openBlock(), _createElementBlock(\"button\", _hoisted_5, \"Ya presente en el carrito\")) : _createCommentVNode(\"v-if\", true), !_ctx.user ? (_openBlock(), _createElementBlock(\"button\", {\n    key: 2,\n    class: \"sign-in\",\n    onClick: _cache[1] || (_cache[1] = (...args) => _ctx.signIn && _ctx.signIn(...args))\n  }, \"Loguearse para añadir al carrito\")) : _createCommentVNode(\"v-if\", true)])])) : _createCommentVNode(\"v-if\", true), !_ctx.product ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [_createVNode(_component_NotFoundPage)])) : _createCommentVNode(\"v-if\", true)], 64 /* STABLE_FRAGMENT */);\n}","map":{"version":3,"names":["key","class","_createElementBlock","_Fragment","_ctx","product","_hoisted_1","_createElementVNode","_hoisted_2","src","imageUrl","_hoisted_3","_hoisted_4","_toDisplayString","name","price","user","itemsIsInCart","onClick","_cache","args","addToCart","_createCommentVNode","_hoisted_5","signIn","_hoisted_6","_createVNode","_component_NotFoundPage"],"sources":["C:\\Users\\User\\OneDrive\\VALENTINA\\Escritorio\\vue\\front-end\\src\\pages\\ProductDetailPage.vue"],"sourcesContent":["<template>\r\n    <div v-if=\"product\">\r\n        <div class=\"img-wrap\">\r\n            <img :src=\"product.imageUrl\" />\r\n        </div>\r\n        <div class=\"product-details\">\r\n            <h1>{{ product.name }}</h1>\r\n            <h3>{{ product.price }}</h3>\r\n            <button @click=\"addToCart\" class=\"add-to-cart\" v-if=\"user && !itemsIsInCart\"> Add to cart</button>\r\n            <button  class=\"grey-button\" v-if=\"user && itemsIsInCart\">Ya presente en el carrito</button>\r\n            <button class=\"sign-in\" @click=\"signIn\" v-if=\"!user\">Loguearse para añadir al carrito</button>\r\n        </div>\r\n    </div>\r\n    <div v-if=\"!product\">\r\n        <NotFoundPage/>\r\n    </div>\r\n</template>\r\n\r\n\r\n<script>\r\nimport {getAuth, sendSignInLinkToEmail, signInWithEmailLink, isSignInWithEmailLink} from 'firebase/auth'\r\nimport NotFoundPage from './NotFoundPage.vue';\r\nimport axios from 'axios';\r\n\r\nexport default {\r\n    name: \"ProductDetailsPage\",\r\n    props: ['user'],\r\n    data() {\r\n        return { \r\n            product: {},\r\n            cartItems: [],\r\n        }\r\n    },\r\n    components: {\r\n        NotFoundPage,\r\n    },\r\n    computed: {\r\n        itemsIsInCart(){\r\n            return this.cartItems.some(item => item.id == this.$route.params.productId);\r\n        }\r\n    },\r\n    watch : {\r\n        async user(newUserValue){\r\n            if (newUserValue) {\r\n                const cartResponse = await axios.get(`/api/users/${newUserValue.uid}/cart`);\r\n                const cartItems = cartResponse.data;\r\n                this.cartItems = cartItems;\r\n            }\r\n        }\r\n    },\r\n    methods: {\r\n        async addToCart () {\r\n            await axios.post(`/api/users/12345/cart', {id: this.$route.params.productId});\r\n            alert('Agregado al carrito')\r\n        },\r\n        async signIn() {\r\n            const email = prompt('Please enter your email to sign in:');\r\n            const auth = getAuth();\r\n            const actionCodeSettings = {\r\n                url: `http://localhost:8080/products/${this.$route.params.productId}`,\r\n                handleCodeInApp: true,\r\n            }\r\n            await sendSignInLinkToEmail(auth, email, actionCodeSettings);\r\n            alert('Fue enviado un link para loguearse al email provisto');\r\n            window.localStorage.setItem('emailForSignIn', email);\r\n        }\r\n\r\n    },\r\n    async created() {\r\n        const auth = getAuth();\r\n        if (isSignInWithEmailLink(auth, window.location.href)) {\r\n            const email = window.localStorage.getItem('emailForSignIn');\r\n            await signInWithEmailLink(auth, email, window.location.href);\r\n            alert('Succesfully signed in');\r\n            window.localStorage.removeItem('emailForSignIn');\r\n        }\r\n\r\n        const response = await axios.get(`http://127.0.0.1:8000/api/products/${this.$route.params.productId}`);\r\n        const product = response.data;\r\n        this.product = product;\r\n        if(this.user) {\r\n            const cartResponse = await axios.get(`/api/users/${this.user.uid}/cart`);\r\n            const cartItems = cartResponse.data;\r\n            this.cartItems = cartItems;\r\n        }\r\n        \r\n\r\n    }\r\n    \r\n}\r\n</script>"],"mappings":";;EAAAA,GAAA;AAAA;;EAEaC,KAAK,EAAC;AAAU;mBAF7B;;EAKaA,KAAK,EAAC;AAAiB;;EALpCD,GAAA;EASqBC,KAAK,EAAC;;;EAT3BD,GAAA;AAAA;;;uBAAAE,mBAAA,CAAAC,SAAA,SACeC,IAAA,CAAAC,OAAO,I,cAAlBH,mBAAA,CAWM,OAZVI,UAAA,GAEQC,mBAAA,CAEM,OAFNC,UAEM,GADFD,mBAAA,CAA+B;IAAzBE,GAAG,EAAEL,IAAA,CAAAC,OAAO,CAACK;0BAH/BC,UAAA,E,GAKQJ,mBAAA,CAMM,OANNK,UAMM,GALFL,mBAAA,CAA2B,YAAAM,gBAAA,CAApBT,IAAA,CAAAC,OAAO,CAACS,IAAI,kBACnBP,mBAAA,CAA4B,YAAAM,gBAAA,CAArBT,IAAA,CAAAC,OAAO,CAACU,KAAK,kBACiCX,IAAA,CAAAY,IAAI,KAAKZ,IAAA,CAAAa,aAAa,I,cAA3Ef,mBAAA,CAAkG;IAR9GF,GAAA;IAQqBkB,OAAK,EAAAC,MAAA,QAAAA,MAAA,UAAAC,IAAA,KAAEhB,IAAA,CAAAiB,SAAA,IAAAjB,IAAA,CAAAiB,SAAA,IAAAD,IAAA,CAAS;IAAEnB,KAAK,EAAC;KAA4C,cAAY,KARrGqB,mBAAA,gBAS+ClB,IAAA,CAAAY,IAAI,IAAIZ,IAAA,CAAAa,aAAa,I,cAAxDf,mBAAA,CAA4F,UAA5FqB,UAA4F,EAAlC,2BAAyB,KAT/FD,mBAAA,gB,CAU2DlB,IAAA,CAAAY,IAAI,I,cAAnDd,mBAAA,CAA8F;IAV1GF,GAAA;IAUoBC,KAAK,EAAC,SAAS;IAAEiB,OAAK,EAAAC,MAAA,QAAAA,MAAA,UAAAC,IAAA,KAAEhB,IAAA,CAAAoB,MAAA,IAAApB,IAAA,CAAAoB,MAAA,IAAAJ,IAAA,CAAM;KAAe,kCAAgC,KAVjGE,mBAAA,e,OAAAA,mBAAA,gB,CAagBlB,IAAA,CAAAC,OAAO,I,cAAnBH,mBAAA,CAEM,OAfVuB,UAAA,GAcQC,YAAA,CAAeC,uBAAA,E,KAdvBL,mBAAA,e","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}