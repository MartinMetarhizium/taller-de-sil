{"ast":null,"code":"import { getAuth, sendSignInLinkToEmail, signInWithEmailLink, isSignInWithEmailLink } from 'firebase/auth';\nimport NotFoundPage from './NotFoundPage.vue';\nimport axios from 'axios';\nexport default {\n  name: \"ProductDetailsPage\",\n  props: ['user'],\n  data() {\n    return {\n      product: {},\n      cartItems: []\n    };\n  },\n  components: {\n    NotFoundPage\n  },\n  computed: {\n    itemsIsInCart() {\n      return this.cartItems.some(item => item.id == this.$route.params.productId);\n    }\n  },\n  watch: {\n    async user(newUserValue) {\n      if (newUserValue) {\n        const cartResponse = await axios.get(`/api/users/${newUserValue.uid}/cart`);\n        const cartItems = cartResponse.data;\n        this.cartItems = cartItems;\n      }\n    }\n  },\n  methods: {\n    async addToCart() {\n      await axios.post(`/api/users/12345/cart`, {\n        id: this.$route.params.productId\n      });\n      alert('Agregado al carrito');\n    },\n    async signIn() {\n      const email = prompt('Please enter your email to sign in:');\n      const auth = getAuth();\n      const actionCodeSettings = {\n        url: `http://localhost:8080/products/${this.$route.params.productId}`,\n        handleCodeInApp: true\n      };\n      await sendSignInLinkToEmail(auth, email, actionCodeSettings);\n      alert('Fue enviado un link para loguearse al email provisto');\n      window.localStorage.setItem('emailForSignIn', email);\n    }\n  },\n  async created() {\n    const auth = getAuth();\n    if (isSignInWithEmailLink(auth, window.location.href)) {\n      const email = window.localStorage.getItem('emailForSignIn');\n      await signInWithEmailLink(auth, email, window.location.href);\n      alert('Succesfully signed in');\n      window.localStorage.removeItem('emailForSignIn');\n    }\n    const response = await axios.get(`http://127.0.0.1:8000/api/products/${this.$route.params.productId}`);\n    const product = response.data;\n    this.product = product;\n    if (this.user) {\n      const cartResponse = await axios.get(`/api/users/${this.user.uid}/cart`);\n      const cartItems = cartResponse.data;\n      this.cartItems = cartItems;\n    }\n  }\n};","map":{"version":3,"names":["getAuth","sendSignInLinkToEmail","signInWithEmailLink","isSignInWithEmailLink","NotFoundPage","axios","name","props","data","product","cartItems","components","computed","itemsIsInCart","some","item","id","$route","params","productId","watch","user","newUserValue","cartResponse","get","uid","methods","addToCart","post","alert","signIn","email","prompt","auth","actionCodeSettings","url","handleCodeInApp","window","localStorage","setItem","created","location","href","getItem","removeItem","response"],"sources":["C:\\Users\\User\\OneDrive\\VALENTINA\\Escritorio\\vue\\front-end\\src\\pages\\ProductDetailPage.vue"],"sourcesContent":["<template>\r\n    <div v-if=\"product\">\r\n        <div class=\"img-wrap\">\r\n            <img :src=\"product.imageUrl\" />\r\n        </div>\r\n        <div class=\"product-details\">\r\n            <h1>{{ product.name }}</h1>\r\n            <h3>{{ product.price }}</h3>\r\n            <button @click=\"addToCart\" class=\"add-to-cart\" v-if=\"user && !itemsIsInCart\"> Add to cart</button>\r\n            <button  class=\"grey-button\" v-if=\"user && itemsIsInCart\">Ya presente en el carrito</button>\r\n            <button class=\"sign-in\" @click=\"signIn\" v-if=\"!user\">Loguearse para a√±adir al carrito</button>\r\n        </div>\r\n    </div>\r\n    <div v-if=\"!product\">\r\n        <NotFoundPage/>\r\n    </div>\r\n</template>\r\n\r\n\r\n<script>\r\nimport {getAuth, sendSignInLinkToEmail, signInWithEmailLink, isSignInWithEmailLink} from 'firebase/auth'\r\nimport NotFoundPage from './NotFoundPage.vue';\r\nimport axios from 'axios';\r\n\r\nexport default {\r\n    name: \"ProductDetailsPage\",\r\n    props: ['user'],\r\n    data() {\r\n        return { \r\n            product: {},\r\n            cartItems: [],\r\n        }\r\n    },\r\n    components: {\r\n        NotFoundPage,\r\n    },\r\n    computed: {\r\n        itemsIsInCart(){\r\n            return this.cartItems.some(item => item.id == this.$route.params.productId);\r\n        }\r\n    },\r\n    watch : {\r\n        async user(newUserValue){\r\n            if (newUserValue) {\r\n                const cartResponse = await axios.get(`/api/users/${newUserValue.uid}/cart`);\r\n                const cartItems = cartResponse.data;\r\n                this.cartItems = cartItems;\r\n            }\r\n        }\r\n    },\r\n    methods: {\r\n        async addToCart () {\r\n            await axios.post(`/api/users/12345/cart`, {id: this.$route.params.productId});\r\n            alert('Agregado al carrito')\r\n        },\r\n        async signIn() {\r\n            const email = prompt('Please enter your email to sign in:');\r\n            const auth = getAuth();\r\n            const actionCodeSettings = {\r\n                url: `http://localhost:8080/products/${this.$route.params.productId}`,\r\n                handleCodeInApp: true,\r\n            }\r\n            await sendSignInLinkToEmail(auth, email, actionCodeSettings);\r\n            alert('Fue enviado un link para loguearse al email provisto');\r\n            window.localStorage.setItem('emailForSignIn', email);\r\n        }\r\n\r\n    },\r\n    async created() {\r\n        const auth = getAuth();\r\n        if (isSignInWithEmailLink(auth, window.location.href)) {\r\n            const email = window.localStorage.getItem('emailForSignIn');\r\n            await signInWithEmailLink(auth, email, window.location.href);\r\n            alert('Succesfully signed in');\r\n            window.localStorage.removeItem('emailForSignIn');\r\n        }\r\n\r\n        const response = await axios.get(`http://127.0.0.1:8000/api/products/${this.$route.params.productId}`);\r\n        const product = response.data;\r\n        this.product = product;\r\n        if(this.user) {\r\n            const cartResponse = await axios.get(`/api/users/${this.user.uid}/cart`);\r\n            const cartItems = cartResponse.data;\r\n            this.cartItems = cartItems;\r\n        }\r\n        \r\n\r\n    }\r\n    \r\n}\r\n</script>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}